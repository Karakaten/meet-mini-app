<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ó–∞—è–≤–∫–∞ –û–ª–µ–∫—Å–∞–Ω–¥—Ä—É</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root { 
      --primary: #a855f7; 
      --bg: #0f172a; 
      --card-bg: rgba(30, 41, 59, 0.7); 
    }
    
    * { box-sizing: border-box; font-family: 'Segoe UI', system-ui, sans-serif; }
    
    body { 
      margin: 0; 
      background: radial-gradient(circle at top right, #1e1b4b, #0f172a); 
      color: #f8fafc; 
      display: flex; justify-content: center; align-items: center; 
      min-height: 100vh; padding: 20px;
      overflow: hidden;
    }

    .card { 
      background: var(--card-bg); 
      backdrop-filter: blur(12px); 
      -webkit-backdrop-filter: blur(12px); 
      border: 1px solid rgba(255, 255, 255, 0.1); 
      border-radius: 24px; padding: 25px; 
      width: 100%; max-width: 380px; 
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
    }

    h1 { font-size: 26px; margin: 0 0 5px 0; background: linear-gradient(to right, #f472b6, #a855f7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
    p { color: #94a3b8; margin-bottom: 20px; font-size: 14px; text-align: center; }

    .label { font-size: 11px; color: #64748b; margin: 10px 0 5px 5px; text-transform: uppercase; letter-spacing: 1px; display: block; }
    
    input { 
      width: 100%; padding: 12px; border-radius: 12px; 
      border: 1px solid rgba(255, 255, 255, 0.1); 
      background: rgba(15, 23, 42, 0.6); color: #fff; font-size: 16px; 
      margin-bottom: 10px; transition: 0.3s;
    }
    input:focus { outline: none; border-color: var(--primary); }
    
    input[type="date"]::-webkit-calendar-picker-indicator, 
    input[type="time"]::-webkit-calendar-picker-indicator { 
      filter: invert(1); cursor: pointer; 
    }

    .row { display: flex; gap: 10px; }
    .row > div { flex: 1; }

    .formats { display: flex; gap: 8px; margin: 10px 0 20px 0; }
    .format-btn { 
      flex: 1; padding: 10px 5px; border-radius: 12px; 
      background: rgba(51, 65, 85, 0.4); border: 1px solid rgba(255, 255, 255, 0.1); 
      color: #fff; cursor: pointer; font-size: 12px; transition: 0.2s; 
      display: flex; flex-direction: column; align-items: center; 
    }
    .format-btn span { font-size: 18px; margin-bottom: 4px; }
    .format-btn.active { 
      background: var(--primary); border-color: var(--primary); 
      box-shadow: 0 0 15px rgba(168, 85, 247, 0.4); 
    }

    .submit { 
      width: 100%; padding: 16px; border-radius: 16px; border: none; 
      background: linear-gradient(45deg, #a855f7, #ec4899); 
      color: #fff; font-size: 16px; font-weight: bold; cursor: pointer; 
      transition: 0.3s; box-shadow: 0 4px 14px rgba(168, 85, 247, 0.3); 
    }
    .submit:disabled { opacity: 0.6; cursor: not-allowed; }
  </style>
</head>
<body>

  <div class="card">
    <h1>‚ú® –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</h1>
    <p>–ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –¥–ª—è —Å–≤—è–∑–∏</p>
    
    <span class="label">–¢–≤–æ–µ –∏–º—è</span>
    <input id="name" type="text" placeholder="üë§ –ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?" />

    <div class="row">
      <div>
        <span class="label">–î–∞—Ç–∞</span>
        <input id="date" type="date" />
      </div>
      <div>
        <span class="label">–í—Ä–µ–º—è</span>
        <input id="time" type="time" />
      </div>
    </div>

    <span class="label">–§–æ—Ä–º–∞—Ç –≤—Å—Ç—Ä–µ—á–∏</span>
    <div class="formats">
      <button class="format-btn" onclick="setFormat(this, 'üç∫ –ü–∏–≤–æ')"><span>üç∫</span>–ü–∏–≤–æ</button>
      <button class="format-btn" onclick="setFormat(this, 'üè† –í –≥–æ—Å—Ç–∏')"><span>üè†</span>–í –≥–æ—Å—Ç–∏</button>
      <button class="format-btn" onclick="setFormat(this, 'üö® –°—Ä–æ—á–Ω–æ')"><span>üö®</span>–°—Ä–æ—á–Ω–æ</button>
    </div>

    <button class="submit" id="main-btn" onclick="sendData()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å üöÄ</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    // –ö—Ä–∞—Å–∏–º —Ö–µ–¥–µ—Ä –≤ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞
    tg.setHeaderColor('#0f172a');

    let selectedFormat = "–ù–µ –≤—ã–±—Ä–∞–Ω";
    const BOT_TOKEN = '8522129872:AAGAIJn9K05673T86y4boB8drP8MYwwNCN4';
    const MY_ID = '269547089';

    // –ê–≤—Ç–æ-–¥–∞—Ç–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
    document.getElementById('date').valueAsDate = new Date();

    function setFormat(el, val) {
      document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('active'));
      el.classList.add('active');
      selectedFormat = val;
      if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
    }

    async function sendData() {
      const name = document.getElementById('name').value || "–ê–Ω–æ–Ω–∏–º";
      const date = document.getElementById('date').value || "–ù–µ –≤—ã–±—Ä–∞–Ω–∞";
      const time = document.getElementById('time').value || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";
      
      // –ë–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–ª—É—á–∞–µ–º –Ω–∏–∫–Ω–µ–π–º
      let username = "hidden";
      if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        username = tg.initDataUnsafe.user.username || tg.initDataUnsafe.user.first_name || "User";
      }
      
      const text = `<b>üéâ –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê!</b>\n\n` +
                   `üë§ <b>–ö—Ç–æ:</b> ${name}\n` +
                   `‚úàÔ∏è <b>–¢–≥:</b> @${username}\n` +
                   `üìÖ <b>–î–∞—Ç–∞:</b> ${date}\n` +
                   `‚è∞ <b>–í—Ä–µ–º—è:</b> ${time}\n` +
                   `üìç <b>–§–æ—Ä–º–∞—Ç:</b> ${selectedFormat}`;
      
      const btn = document.getElementById('main-btn');
      btn.innerText = "–û—Ç–ø—Ä–∞–≤–∫–∞...";
      btn.disabled = true;

      try {
        // 1. –ü—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ –ø—Ä—è–º—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –±–æ—Ç–æ–º
        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            chat_id: MY_ID, 
            text: text, 
            parse_mode: 'HTML' 
          })
        });

        if (response.ok) {
          if(tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
          tg.close();
        } else {
          // 2. –ï—Å–ª–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è (CORS), –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –¢–ì
          tg.sendData(text);
          setTimeout(() => tg.close(), 100);
        }
      } catch (e) {
        // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ —Å–ª—É—á–∞–π —Å–µ—Ç–µ–≤–æ–π –æ—à–∏–±–∫–∏
        tg.sendData(text);
        setTimeout(() => tg.close(), 100);
      }
    }
  </script>
</body>
</html>
